# Бизнес цели

1. Увеличение количества клиентов на 20% в первый год и 10% в каждый последующий.
2. Увеличение продаж спортивных товаров на 15% ежегодно.
3. Повышение узнаваемости бренда на 30% за год.

# Стейкхолдеры
1. Спортсмен
   Зарегистрированный пользователь,который использует функции приложения, потенциальный покупатель товаров. Интересы: качество товаров, цена, поиск единомышленников, ведение здорового образа жизни.
2. Менеджер
   Сотрудник компании, который актуализирует стоимость товаров в Каталоге товаров. Интересы: управление стоимостью товаров, продажа товаров.
3. Инструктор
   Зарегистрированный пользователь, наделенный правами от лица компании на составление планов тренировок. Интересы: поиск единомышленников и клиентов.
4. Администратор
   Сотрудник компании, имеющий права администратора в системах. Интересы: управление приложением.

# Концептуальная схема
<https://github.com/alice-rosso/architecture/blob/main/schemes/conceptual.md>

# Функциональные требования (ФТ)
<https://github.com/alice-rosso/architecture/blob/main/FR.adoc>

# Нефункциональные требования (НФТ)
1. Пользователь приложения/веб-интерфейса запрашивает информацию/выполняет действие  в течение часа пик и получает ответ в течение 5 секунд
2. Недоступность приложения/веб-интерфейса в случае отказа всех серверов не должна превышать 20% в сутки от общей доступности
3. Половина серверов отказывает в течение обычных часов работы без наступления ухудшения общей доступности системы
4. Пользователю приложения/веб-интерфейса доступна информация/действие только в соответствии с его ролью
5. Пользователь приложения/веб-интерфейса должен пройти аутентфикацию для входа 
6. Увеличение количества пользователей на 20% в первый год и на 31% в каждый последующий не приводит к ухудшению показателей производительности и доступности
7. Приложение должо поддерживать несколько языков: русский, английсий, китайский
8. Приложение должно обеспечить работу следующих функций в случае отсутствия интернета: просмотр расписания тренировок, и плана тренировок из расписания, ввод вручную результатов тренировок
9. Для приложения и веб-интерфейса хранятся логи в течени 2 недель.
10. Для приложения и веб-интерфейса вдедется мониторинг основных функций.

# Атрибуты качества:
1. Доступность
2. Производительность
3. Юзабилити

# Ограничения и риски:
1. Новое приложение устанавливается совместно с приложением для покупуи товаров. Если у пользователя нет старого приложения, то он не сможет оформить покупку товара.
2. Приложения для считывания результатов могут быть недоступны в некоторых регионах.
3. Получение роли инструктора возможно только при соблюдении определнных условий и через связь с организацией.
4. Новое приложение, а также выбранные приложения для считывания показателей тренировки могут попасть под санкции в регионе и быть недоступными для скачивания.
5. Автоматическая передача результатов тренировки возможна только при использовании определенных дополнительных приложений.
6. При отсутствии Интернета возможно отображение ограниченных данных, основанных на данных последнего входа в приложение.
7. Расределенна команда разработки с разными часовыми поясами и языковым барьером.
8. БД с пользователями должна располагаться на территории РФ, так как хранит персональные данные.

# Критические бизнес-сценарии
1. Создание инструктором плана тренировки в приложении
2. Создание списка оборудования для тренировки из каталога товаров
3. Доступ в приложение спортсмена для просмотра тренировок
4. Переход в приложение для покупки товара

# План поэтапной разработки
## 1 этап
Реализация критических бизнес-сценариев.
Функции:
* Создание нового приложения FitLife на двух платформах - iOS и Android , с ролевым доступо для Спортсменов и Инструкторов.
* Базовая функциональность администратора для управления Пользователями
* У инструктора в приложении должна быть возможность создавать план тренировок с требуемым оборудованием. Поиск оборудования выполняется из каталога товаров.
* У спортсмена в приложении должна быть возможность просмотреть план тренировки, а также купить необходимое оборудование. Для покупки товара используется старое приложение, в которое спортсмен переходит по ссылке.

## 2 этап 
Расширение функций приложения FitLife.
* У спортсмена в приложении должна быть возможность по автоматическому или ручному сбору показателей тренировки, анализу показателей.
* У инструктора и спортсмена в приложении должна быть возможность создавать расписание тренировок
* У инструктора и спортсмена в приложении должна быть возможность создания соревнований с планом тренировок для подготовки к нему, выбора соревнования для участия

## 3 этап 
Веб-интерфейс для менеджера и администратора
* У менеджера должна быть возможность создания акций
* У менеджера должна быть возможность настраивать уведомления по акциям
* У менеджера должна быть возможность управлять ценами товаров в каталоге товаров
* У администратора должна быть возмжность управлять системами
Расширение функций приложения FitLife.
* У пользователя приложения должна быть возможность получать уведомления
* У спортсменов и инструкторов долдан ыбыть возможность создавать тематические каналы, отправлять ссылку-приглашение в канал, обмениваться сообщениями внутри канала.
  
# ADR
1. Перенос приложения по продаже товаров в новое приложение +
На текущем этапе достаточно переадресовывать в другое приложение. В случае негативной обратной связи возможна реализация другого варианта.
2. Выбор БД +
Выбрана одна СУБД, так как поддержка и проектирвоание нескольких БД потребует больше экспертизы и времени. Также на данном этапе необходимости в выделении несокльких СУБД не выявлено, все требования покрываются СУБД PostgreSQL.
3. Инфраструктура
Выбрано 2 ЦОДа, на данном этапе достаточно согалсно экспертной оценке. Позволяют распределять нагрузку и сохранять функциональную доступность в случае отказа одного ЦОДа.

# Общее описание архитектуры
1. БД
СУБД PostgreSQL, так как предоставляется большинством облачных сервисов, обладает возможностями полнотекстового поиска, производительна.
2. Асинхронные интеграции
Асинхронные взаимодействия выбраны для отправки уведомлений и сохранения показателей тренировки, так как пользователь может находиться в зоне отсутствия интернета какое-то время.
Выбрана схема логов и инструмент Kafka , чтобы иметь возможность перечитывать сообщений.
4. Синхронные интеграции
Синхронные интеграции релаизуются на основе архитектурного стиля REST.
5. API Gateway
Внутренние и внешние интеграции реализуются через API Gateway
6. Все ресурсы для нового приложения арендуются в облачных сервисах.
7. Все обращения к БД и API Gateway должны быть рализованы с аутентификацией и авторизацией.
      
# Сценарии использования
## Спортсмен
### Покупка товаров
1. Пользователь авторизуется в приложении FitLife с ролью  Спортсмен
2. Спортсмен переходит в раздел Тренировки
3. Спортсмен просмотаривает данные о тренировке и необходимом инвентаре
4. Спортсмен переходит по ссылку на инвентарь
5. Открывается приложение для покупки товаров
6. Сопртсмен оформляет заказ на товар 

### Проведение тренировки
1. Пользователь авторизуется в приложении FitLife с ролью  Спортсмен
2. Спортсмен переходит в раздел Тренировки
3. Спортсмен проводит тренировку
4. Результаты о тренировке загружаются в приложение
   4.1 Автоматически при использовании определенных приложений для сора показателей
   4.2 Вручную спортсменом в приложении FitLife   
6. Спортсмен видит статистику за период по проведенным тренировкам

### Составление расписания тренировок
1. Пользователь авторизуется в приложении FitLife с ролью  Спортсмен
2. Спортсмен переходит в раздел Тренировки
3. Спортсмен составляет личное расписание из тренировок

### Участие в соревновании
1. Пользователь авторизуется в приложении FitLife с ролью  Спортсмен
2. Спортсмен переходит в раздел Соревнования
3. Спортсмен выбирает соревнование для участия
4. Спортсмен просматривает план тренировок и оборудование для подготовки к соревнованию

### Общение в социальных группах
1. Пользователь авторизуется в приложении FitLife с ролью  Спортсмен или Инструктор
2. Спортсмен/Инструктор переходит в раздел Форум
3. Спортсмен/Инструктор открывает интересующий канал
4. Спортсмен/Инструктор отправляет сообщения в канале

## Менеджер
### Составление акции 
1. Пользователь авторизуется в веб-интерфейсе с ролью  Менеджер
2. Менеджер создает акцию на товары
3. Менеджер формирует текст уведомления и запускает процесс отправки уведомлений 

### Редактирование товара
1. Пользователь авторизуется в веб-интерфейсе с ролью  Менеджер
2. Менеджер редактирует информацию о товарах

## Инструктор
### Составление плана тренировки
1. Пользователь авторизуется в приложении FitLife с ролью Инструктор
2. Инструктор переходит в раздел Тренировки
3. Инструктор создает план тренировки и выбирает необходимое оборудование

### Участие в соревновании
1. Пользователь авторизуется в приложении FitLife с ролью  Инструктор
2. Инструктор переходит в раздел Соревнования
3. Инструктор выбирает соревнование для участия
4. Инструктор просматривает план тренировок и оборудование для подготовки к соревнованию

# Схемы решения
## Общая архитектура
<https://github.com/alice-rosso/architecture/blob/main/schemes/common.md>

## Функциональное представление
<https://github.com/alice-rosso/architecture/blob/main/schemes/functional.md>

## Информационное представление
<https://github.com/alice-rosso/architecture/blob/main/schemes/informational.md>

## Безопасность
<https://github.com/alice-rosso/architecture/blob/main/schemes/security.md>

## Инфраструктура
<https://github.com/alice-rosso/architecture/blob/main/schemes/infractructure.md>

# Архитектурные риски
1. Использование арендованных ресурсов
   Требуется заложение бюджета в проект ежегодно. Существует риск непредвиденных проблем на стороне арендодателя.

# Стоимость владения системой (облачный провайдер Selectel)
## 1 год
Стоимость 1 сервера 4 vCPU,8 ГБ RAM,5 ГБ SSD - 4000/мес,
БД PostgreSQL с фиксированной конифгурацией 4 vCPU, 16 ГБ RAM, 128 ГБ - 11000/мес. 
Итого - 228000 в год с учетом использования 2 серверов.

## 2 год
Ожидаемый рост клиентов - 20%. Выбранные мощности покрывают данные требования.
Итого - 228000 в год с учетом использования 2 серверов.

## 5 год
Ожидаемый рост клиентов - 10% в каждый. 
Стоимость 1 сервера 6 vCPU, 32 ГБ RAM, 5 ГБ SSD- 14000/мес.
БД PostgreSQL с фиксированной конифгурацией  6 vCPU, 64 ГБ RAM, 512 ГБ - 35000/мес. 
Итого - 756000 в год с учетом использования 2 серверов.







